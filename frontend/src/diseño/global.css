@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================= */
/*      VARIABLES FLUIDAS        */
/* ============================= */
@layer base {
  :root {
    /* Colores del sistema - Modo Claro */
    --background: 20 50% 97%;
    --foreground: 20 10% 20%;
    --card: 0 0% 100%;
    --card-foreground: 20 10% 20%;
    --popover: 0 0% 100%;
    --popover-foreground: 20 10% 20%;
    --primary: 350 70% 73%;
    --primary-foreground: 210 40% 98%;
    --secondary: 32 95% 75%;
    --secondary-foreground: 20 10% 20%;
    --muted: 20 10% 96%;
    --muted-foreground: 20 10% 60%;
    --accent: 20 50% 90%;
    --accent-foreground: 20 10% 20%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 20 10% 90%;
    --input: 20 10% 90%;
    --ring: 350 70% 73%;

    /* Radios y espaciado */
    --radius: 0.75rem;

    /* Breakpoints (mobile-first) */
    --screen-xs: 480px;
    --screen-sm: 640px;
    --screen-md: 768px;
    --screen-lg: 1024px;
    --screen-xl: 1280px;
    --screen-2xl: 1536px;

    /* Layout responsivo - con valores más fluidos */
    --sidebar-width: min(250px, 85vw);
    --sidebar-width-collapsed: clamp(3rem, 3vw, 4.5rem);
    --header-height: clamp(3.5rem, 5vh, 4.5rem);
    --content-max-width: min(1400px, 95vw);
    --container-padding: clamp(1rem, 3vw, 2rem);

    /* Tipografía fluida mejorada con clamp */
    --text-xs: clamp(0.7rem, 0.7rem + 0.1vw, 0.875rem);
    --text-sm: clamp(0.8rem, 0.8rem + 0.2vw, 1rem);
    --text-base: clamp(0.95rem, 0.95rem + 0.2vw, 1.125rem);
    --text-lg: clamp(1.1rem, 1.1rem + 0.2vw, 1.25rem);
    --text-xl: clamp(1.2rem, 1.2rem + 0.3vw, 1.5rem);
    --text-2xl: clamp(1.4rem, 1.4rem + 0.5vw, 2rem);
    --text-3xl: clamp(1.7rem, 1.7rem + 0.7vw, 2.5rem);
    --text-4xl: clamp(2rem, 2rem + 1vw, 3rem);
    --text-5xl: clamp(2.5rem, 2.5rem + 1.5vw, 4rem);

    /* Espaciado fluido mejorado */
    --spacing-1: clamp(0.25rem, 0.25rem + 0.1vw, 0.375rem);
    --spacing-2: clamp(0.5rem, 0.5rem + 0.15vw, 0.75rem);
    --spacing-3: clamp(0.75rem, 0.75rem + 0.2vw, 1.125rem);
    --spacing-4: clamp(1rem, 1rem + 0.3vw, 1.5rem);
    --spacing-6: clamp(1.5rem, 1.5rem + 0.4vw, 2.25rem);
    --spacing-8: clamp(2rem, 2rem + 0.5vw, 3rem);
    --spacing-10: clamp(2.5rem, 2.5rem + 0.75vw, 3.75rem);

    /* Gaps para grids y flexbox */
    --gap-xs: clamp(0.5rem, 1vw, 0.75rem);
    --gap-sm: clamp(0.75rem, 1.5vw, 1rem);
    --gap-md: clamp(1rem, 2vw, 1.5rem);
    --gap-lg: clamp(1.5rem, 3vw, 2rem);
  }

  /* Modo Oscuro */
  .dark {
    --background: 240 10% 10%;
    --foreground: 0 0% 98%;
    --card: 240 10% 13%;
    --card-foreground: 0 0% 98%;
    --popover: 240 10% 13%;
    --popover-foreground: 0 0% 98%;
    --primary: 267 100% 65%;
    --primary-foreground: 0 0% 98%;
    --secondary: 240 10% 16%;
    --secondary-foreground: 0 0% 98%;
    --muted: 240 10% 15%;
    --muted-foreground: 240 5% 65%;
    --accent: 267 100% 65%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 10% 16%;
    --input: 240 10% 16%;
    --ring: 267 100% 65%;
  }
}

/* ============================= */
/*          RESETEO BASE        */
/* ============================= */
@layer base {
  * {
    @apply border-border;
  }

  html {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }

  body {
    @apply bg-background text-foreground;
    min-height: 100vh;
    min-height: 100dvh; /* Mejor soporte para móviles */
    overflow-x: hidden;
  }

  /* Tipografía responsiva */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply font-medium tracking-tight;
    word-wrap: break-word;
  }

  h1 {
    font-size: var(--text-3xl);
    line-height: 1.2;
  }

  h2 {
    font-size: var(--text-2xl);
    line-height: 1.3;
  }

  h3 {
    font-size: var(--text-xl);
    line-height: 1.4;
  }

  h4 {
    font-size: var(--text-lg);
    line-height: 1.5;
  }

  p {
    font-size: var(--text-base);
    line-height: 1.6;
  }

  /* Mejoras para accesibilidad */
  :focus-visible {
    @apply outline-2 outline-offset-2 outline-primary;
  }

  /* Scrollbar personalizada */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-muted;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-muted-foreground/50 rounded-full;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-muted-foreground;
  }
}

/* ============================= */
/*       COMPONENTES UI          */
/* ============================= */
@layer components {
  /* Gradientes */
  .bg-primary-gradient {
    @apply bg-gradient-to-r from-primary to-purple-400 dark:from-purple-600 dark:to-purple-400;
  }

  /* Cards - Mejoradas para responsividad */
  .card {
    @apply relative bg-card rounded-xl border border-border shadow-sm transition-all duration-200;
    padding: var(--spacing-4);
  }

  .card-hover {
    @apply hover:shadow-lg hover:border-primary/50;
    transform: translateY(0);
    transition: transform 0.2s ease, box-shadow 0.2s ease,
      border-color 0.2s ease;
  }

  .card-hover:hover {
    transform: translateY(-4px);
  }

  .card-header {
    padding: var(--spacing-4);
    @apply border-b border-border;
  }

  .card-content {
    padding: var(--spacing-4);
  }

  .card-footer {
    padding: var(--spacing-3) var(--spacing-4);
    @apply border-t border-border bg-muted;
  }

  /* Efectos y animaciones */
  .hover-effect {
    @apply transition-all duration-200;
    transform: scale(1);
  }

  .hover-effect:hover {
    transform: scale(1.05);
  }

  .fade-in {
    @apply animate-in fade-in duration-300;
  }

  .slide-in {
    @apply animate-in slide-in-from-bottom duration-300;
  }

  /* Formularios - Mejorados para responsividad */
  .form {
    @apply flex flex-col w-full mx-auto;
    gap: var(--spacing-4);
    max-width: min(600px, 100%);
  }

  .form-group {
    @apply flex flex-col;
    gap: var(--spacing-2);
  }

  .form-row {
    @apply flex flex-wrap;
    gap: var(--gap-md);
  }

  .form-row > * {
    @apply flex-1;
    min-width: min(250px, 100%);
  }

  .form-label {
    @apply block text-sm font-medium text-foreground;
    margin-bottom: var(--spacing-1);
  }

  .form-input,
  .form-select,
  .form-textarea {
    @apply w-full text-foreground bg-background border-2 border-border rounded-md transition-all
      focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 disabled:bg-muted disabled:cursor-not-allowed disabled:opacity-70;
    padding: 0.75rem 1rem;
    font-size: var(--text-base);
    line-height: 1.5;
  }

  .form-error {
    @apply text-sm text-destructive;
    margin-top: var(--spacing-1);
  }

  .form-help {
    @apply text-sm text-muted-foreground;
    margin-top: var(--spacing-1);
  }

  .form-actions {
    @apply flex justify-end;
    gap: var(--gap-sm);
    margin-top: var(--spacing-6);
  }

  /* Layout general - Mejorado para responsividad */
  .layout {
    @apply flex min-h-screen bg-background;
  }

  .page-container {
    min-height: 100vh;
    min-height: 100dvh;
    width: 100%;
  }

  /* Dashboard - Mejorado para responsividad */
  .dashboard {
    @apply min-h-screen bg-background;
    padding: var(--container-padding);
  }

  .dashboard-header {
    @apply flex flex-col gap-4 mb-8;
    margin-bottom: var(--spacing-8);
  }

  @media (min-width: 640px) {
    .dashboard-header {
      @apply flex-row justify-between items-center gap-0;
    }
  }

  .dashboard-title {
    @apply font-bold text-foreground;
    font-size: var(--text-2xl);
  }

  .dashboard-grid {
    display: grid;
    gap: var(--gap-md);
    grid-template-columns: 1fr;
  }

  @media (min-width: 640px) {
    .dashboard-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .dashboard-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  @media (min-width: 1280px) {
    .dashboard-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  @media (min-width: 1536px) {
    .dashboard-grid {
      grid-template-columns: repeat(5, 1fr);
    }
  }

  /* Header fijo y responsive - Mejorado */
  .header {
    @apply fixed top-0 left-0 right-0 bg-background/80 backdrop-blur-md border-b border-border z-30 transition-all;
    height: var(--header-height);
  }

  .header-content {
    @apply flex items-center justify-between h-full mx-auto;
    padding-left: var(--container-padding);
    padding-right: var(--container-padding);
    max-width: var(--content-max-width);
  }

  .header-brand {
    @apply flex items-center text-primary font-bold no-underline;
    gap: var(--spacing-3);
    font-size: var(--text-xl);
  }

  .header-nav {
    @apply hidden items-center;
    gap: var(--spacing-6);
  }

  @media (min-width: 768px) {
    .header-nav {
      @apply flex;
    }
  }

  .header-nav-item {
    @apply text-foreground no-underline font-medium transition-colors hover:text-primary;
  }

  .header-actions {
    @apply flex items-center;
    gap: var(--gap-sm);
  }

  /* Menú móvil - Mejorado */
  .mobile-menu-toggle {
    @apply flex items-center justify-center text-foreground;
    width: 2.5rem;
    height: 2.5rem;
  }

  @media (min-width: 768px) {
    .mobile-menu-toggle {
      @apply hidden;
    }
  }

  .mobile-menu {
    @apply fixed inset-0 z-50 bg-background transform transition-transform duration-300 ease-in-out;
    padding-top: var(--header-height);
    transform: translateX(-100%);
  }

  .mobile-menu.open {
    transform: translateX(0);
  }

  .mobile-menu-content {
    @apply h-full overflow-y-auto;
    padding: var(--spacing-4);
  }

  /* Sidebar responsive - Mejorado */
  .sidebar {
    @apply fixed top-0 left-0 h-screen bg-background border-r border-border z-40 transition-all flex flex-col;
    width: var(--sidebar-width);
    transform: translateX(-100%);
  }

  @media (min-width: 768px) {
    .sidebar {
      transform: translateX(0);
    }
  }

  .sidebar.collapsed {
    width: var(--sidebar-width-collapsed);
  }

  .sidebar-header {
    @apply border-b border-border flex items-center justify-between;
    height: var(--header-height);
    padding: 0 var(--spacing-4);
  }

  .sidebar-content {
    @apply flex-1 overflow-y-auto;
    padding: var(--spacing-4);
  }

  .sidebar-nav {
    @apply flex flex-col;
    gap: var(--spacing-2);
  }

  .sidebar-group {
    margin-bottom: var(--spacing-6);
  }

  .sidebar-group-title {
    @apply text-xs font-semibold uppercase text-muted-foreground;
    padding: var(--spacing-2) var(--spacing-4);
  }

  .sidebar-item {
    @apply flex items-center text-foreground no-underline rounded-md transition-all hover:bg-muted hover:text-primary;
    gap: var(--spacing-3);
    padding: var(--spacing-2) var(--spacing-4);
  }

  .sidebar-item.active {
    @apply bg-primary text-primary-foreground;
  }

  /* Grids y contenedores fluidos - Mejorados */
  .responsive-grid {
    display: grid;
    gap: var(--gap-md);
    grid-template-columns: 1fr;
  }

  @media (min-width: 640px) {
    .responsive-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .responsive-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  @media (min-width: 1280px) {
    .responsive-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  .responsive-container {
    @apply mx-auto;
    padding-left: var(--container-padding);
    padding-right: var(--container-padding);
    max-width: var(--content-max-width);
    width: 100%;
  }

  .grid-fluid {
    display: grid;
    gap: var(--gap-md);
    grid-template-columns: repeat(auto-fit, minmax(min(100%, 300px), 1fr));
  }

  .grid-fluid-sm {
    display: grid;
    gap: var(--gap-md);
    grid-template-columns: repeat(auto-fit, minmax(min(100%, 200px), 1fr));
  }

  .grid-fluid-lg {
    display: grid;
    gap: var(--gap-md);
    grid-template-columns: repeat(auto-fit, minmax(min(100%, 400px), 1fr));
  }

  /* Tablas responsivas - Mejoradas */
  .table-container {
    @apply overflow-x-auto w-full;
    margin-left: calc(var(--container-padding) * -1);
    margin-right: calc(var(--container-padding) * -1);
    padding-left: var(--container-padding);
    padding-right: var(--container-padding);
  }

  @media (min-width: 640px) {
    .table-container {
      margin-left: calc(var(--container-padding) * -1);
      margin-right: calc(var(--container-padding) * -1);
    }
  }

  .table-content {
    @apply min-w-full divide-y divide-border;
  }

  .table-responsive {
    @apply w-full overflow-x-auto;
    -webkit-overflow-scrolling: touch;
  }

  .table-responsive table {
    @apply min-w-full;
  }

  /* Tablas responsivas con scroll horizontal en móviles */
  @media (max-width: 767px) {
    .table-responsive-stack {
      display: block;
    }

    .table-responsive-stack thead {
      display: none;
    }

    .table-responsive-stack tbody tr {
      @apply block border-b border-border;
      margin-bottom: var(--spacing-4);
    }

    .table-responsive-stack td {
      @apply block text-right;
      padding: var(--spacing-2) var(--spacing-4);
    }

    .table-responsive-stack td::before {
      content: attr(data-label);
      @apply float-left font-medium text-foreground;
    }
  }

  /* Formularios en grid - Mejorados */
  .form-grid {
    display: grid;
    gap: var(--gap-md);
    grid-template-columns: 1fr;
  }

  @media (min-width: 640px) {
    .form-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  /* Aspect Ratio para contenedores multimedia - Mejorados */
  .aspect-ratio {
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  .aspect-ratio::before {
    content: "";
    display: block;
    padding-top: 56.25%; /* 16:9 por defecto */
  }

  .aspect-ratio-content {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
  }

  .aspect-ratio-1-1::before {
    padding-top: 100%; /* Cuadrado */
  }

  .aspect-ratio-4-3::before {
    padding-top: 75%; /* 4:3 */
  }

  .aspect-ratio-21-9::before {
    padding-top: 42.86%; /* 21:9 ultrawide */
  }
}

/* ============================= */
/*        UTILIDADES EXTRA       */
/* ============================= */
@layer utilities {
  /* Texto con gradiente */
  .text-gradient {
    @apply bg-clip-text text-transparent bg-gradient-to-r from-primary to-purple-400 dark:from-purple-600 dark:to-purple-400;
  }

  /* Utilidades de visibilidad responsive mejoradas (mobile-first) */
  .visible-xs {
    display: initial;
  }
  @media (min-width: 480px) {
    .visible-xs {
      display: none !important;
    }
  }

  .hidden-xs {
    display: none;
  }
  @media (min-width: 480px) {
    .hidden-xs {
      display: initial !important;
    }
  }

  .visible-sm-down {
    display: initial;
  }
  @media (min-width: 640px) {
    .visible-sm-down {
      display: none !important;
    }
  }

  .hidden-sm {
    display: none;
  }
  @media (min-width: 640px) {
    .hidden-sm {
      display: initial !important;
    }
  }

  .visible-md-down {
    display: initial;
  }
  @media (min-width: 768px) {
    .visible-md-down {
      display: none !important;
    }
  }

  .hidden-md {
    display: none;
  }
  @media (min-width: 768px) {
    .hidden-md {
      display: initial !important;
    }
  }

  .visible-lg-down {
    display: initial;
  }
  @media (min-width: 1024px) {
    .visible-lg-down {
      display: none !important;
    }
  }

  .hidden-lg {
    display: none;
  }
  @media (min-width: 1024px) {
    .hidden-lg {
      display: initial !important;
    }
  }

  /* Utilidades para imágenes - Mejoradas */
  .img-fluid {
    max-width: 100%;
    height: auto;
    display: block;
  }

  .img-cover {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
  }

  .img-contain {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: center;
  }

  /* Fix para altura de viewport en móviles */
  .vh-fix {
    height: 100vh;
    height: 100dvh; /* Dynamic viewport height */
  }

  /* Utilidades de espaciado fluido */
  .gap-fluid-sm {
    gap: var(--gap-sm);
  }

  .gap-fluid-md {
    gap: var(--gap-md);
  }

  .gap-fluid-lg {
    gap: var(--gap-lg);
  }

  .p-fluid {
    padding: var(--spacing-4);
  }

  .px-fluid {
    padding-left: var(--spacing-4);
    padding-right: var(--spacing-4);
  }

  .py-fluid {
    padding-top: var(--spacing-4);
    padding-bottom: var(--spacing-4);
  }

  .m-fluid {
    margin: var(--spacing-4);
  }

  .mx-fluid {
    margin-left: var(--spacing-4);
    margin-right: var(--spacing-4);
  }

  .my-fluid {
    margin-top: var(--spacing-4);
    margin-bottom: var(--spacing-4);
  }

  /* Utilidades para contenido seguro en dispositivos con notch */
  .safe-top {
    padding-top: env(safe-area-inset-top, 0);
  }

  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom, 0);
  }

  .safe-left {
    padding-left: env(safe-area-inset-left, 0);
  }

  .safe-right {
    padding-right: env(safe-area-inset-right, 0);
  }

  /* Utilidades para scroll suave */
  .scroll-smooth {
    scroll-behavior: smooth;
  }

  /* Utilidades para contenido que se desborda */
  .truncate-2-lines {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .truncate-3-lines {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
  }
}
